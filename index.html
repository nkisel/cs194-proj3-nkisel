<html><link type="text/css" id="dark-mode" rel="stylesheet" href=""><style type="text/css" id="dark-mode-custom-style"></style><head>
    <style type="text/css">
        img {
            max-width: 450px;
        }
        li {
            list-style-type: none;
        }
        h1 {
            line-height: 40%;
            line-break: normal;
        }
        h2 {
            line-height: 40%;
        }
        p {
            line-height: 95%;
            text-indent: 8px;
            margin: 0;
        }

        .constant-scale {
            width: 400px;
        }

        .center {
            text-align: center;
            padding: 3%;
        }
        .center p {
            text-align: center; 
        }

        .cell {
            display: inline-block;
            text-align: center;
            margin: 8px;
        }
        #side-by-side {
            display: flex;
            flex-direction: row;
            align-items: center;
            flex-wrap: wrap;

        }
        #stacked {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
    <title>Morphing</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
</head>

<body style="padding: 1%;">

    <div class="center">
        <h1 style="font-size: x-large; line-height: 40%;"> Morphing </h1>
        <p><b>COMPSCI 194-26</b>: <i>Computational Photography & Computer Vision</i></p>
        <p>Professors Alexei Efros & Angjoo Kanazawa</p>
        <p>September 26th, 2021</p>
        <p>Nick Kisel</p>
    </div>

    <h2>Foreword</h2>

    <h3>Why'd he choose those images?</h3>

    <p><ul><li>
        Please familiarize yourself with the <i>average fan vs. average enjoyer</i> meme,
        which is readily available online at the time of writing.
        In short, it elevates an action, object, hobby, or belief far over another by
        associating that subject with the individual pictured by the corresponding photograph. 
    </li></ul></p>

    <p> "Gigachad" image courtesy of photographer Krista Sudmalis & model Ernest Khalimov. </p>
    <p> The subject of the "Average Fan" image is YouTuber <i>James' YouNiverse</i>. </p>

    <h2>Fun with Frequencies</h2>

    <h3>Face morphing</h3>

    <p>
        This technique involves selecting an equivalent number of points on matching
        features of the two input images (it is highly important that these points be 
        selected in the exact same order to ensure that the correct regions of the image
        are aligned and morphed).
        This set of points provides a method for us to generate several matching triangles
        on the images. For example, if you take the triangle generated by connecting
        vertices 0, 1, and 2 (or any other set of 3 points) on the input image and 
        compare them to the triangle formed by connecting the vertices of the same numbers
        on the transformation image, you'll notice that the two shapes aren't exactly
        congruent, but they contain the same "content." In the case of a face, this might
        encase a nose, an eye, or the background. Once the corresponding points have been 
        defined, morphing the image becomes a process of transforming the corresponding
        points inside the triangle of the input image to more & more closely match the
        shape of the output image. Then, if you're doing a morph video, you can substitute
        in a mix of the pixels of the input image and transformation image such that the
        middle of the morph sequence becomes the perfect "in-between" image - a
        combination of both the color and shape features of both images.

    </p>

    <div id="stacked">
        <div id="side-by-side">
            <div class="cell">
                <img src="out/nick/0.jpg" alt="Nick">
                <p>&gt; 99.9% Nick</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/nick/165.jpg" alt="Nick">
                <p>Nick's looking a little different</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/nick/179.jpg" alt="Hybrid">
                <p>Giganick</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/nick/194.jpg" alt="Chad">
                <p>Chad</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/nick/359.jpg" alt="Gigachad">
                <p> &gt; 99.9% Gigachad</p>
                <br>
            </div>

        </div>

        <div id="side-by-side">
            <div class="cell">
                <img src="img/nickpoints.jpg" alt="Nick">
                <p>&gt; Nick with input points</p>
                <br>
            </div>

            &

            <div class="cell">
                <img src="img/gigachadpoints.jpg" alt="Gigachad">
                <p>Gigachad with input points</p>
                <br>
            </div>

        </div>
        
        <div id="side-by-side">

            <div class="cell">
                <img src="out/brandon_fan/0.jpg" alt="Brandon">
                <p>Brandon</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/brandon_fan/165.jpg" alt="Brandon">
                <p>(thanks for posing for this!)</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/brandon_fan/179.jpg" alt="Brandon">
                <p>Average Frandon</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/brandon_fan/194.jpg" alt="Brandon">
                <p>Above-average Fan</p>
                <br>
            </div>

            &gt;

            <div class="cell">
                <img src="out/brandon_fan/359.jpg" alt="Brandon">
                <p>Average Fan</p>
                <br>
            </div>
        </div>

        <div id="side-by-side">
            <div class="cell">
                <img src="img/brandon_fanpoints.jpg" alt="Brandon">
                <p>&gt; Brandon with input points</p>
                <br>
            </div>

            &

            <div class="cell">
                <img src="img/fanpoints.png" alt="">
                <p>the Average Fan with input points</p>
                <br>
            </div>

        </div>

        <div>
            <p>
                See the full transformations here:
            </p>
            <video width="320" height="240" controls>
                <source src="giganick.mp4" type="video/mp4">
              Your browser does not support the video tag.
            </video> 
            <iframe width="560" height="315" src="https://www.youtube.com/embed/Ulgmz_LIolY?start=2" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/yTjbqcY7JwI?start=2" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
    </div>

    <hr>

    <div id="stacked">
        <h3>The Mean Face of a population</h3>

        <p> 
            Next, I downloaded the FEI annotated faces database and got to work. This database
            contains 200 unique faces, each with 2 expressions. Each of these 400 total images
            contains 46 total "annotations," or systematically mapped points. That is to say,
            point 0 and 1 always lie on the left and right nostrils, and the rest of the points
            similarly lie on other specifically pre-defined locations and features of the face. 
            <br>
            For each of the 46 points in each annotated face in the dataset, I found the average
            position of each. That is, I found the average position of all left nostrils, all
            right nostrils, noses, eyebrows, chins - you name it. Once I had the average feature
            locations, I put them together into a final "average face" set of points. Here's what
            that looks like.
        </p>

        <div class="cell">
            <img src="population_mean.jpg" alt="Mean face">
            <p>Population mean face.</p>
            <br>
        </div>
        

        <p>
            With this set up, I mapped the same 46 points onto my face.
        </p>

        <div id="side-by-side">
            <div class="cell">
                <img src="img/nick_populationpoints.jpg" alt="">
                <p></p>
                <br>
            </div>

            &

            <div class="cell">
                <img src="img/nick_population.png" alt="">
                <p></p>
                <br>
            </div>
        </div>

        <div id="side-by-side">
            <div class="cell">
                <img src="img/population_mean.jpg" alt="Population mean face">
                <p></p>
                <br>
            </div>

            &

            <div class="cell">
                <img src="img/population_averagepoints.jpg" alt="">
                <p></p>
                <br>
            </div>
        </div>
        
        <div id="side-by-side">
            <div class="cell">
                <img src="out/population_average_on_nick.png" alt="Population mean face">
                <p>Population mean stretched to my face</p>
                <br>
            </div>

            &

            <div class="cell">
                <img src="out/nick_population_average.jpg" alt="">
                <p>My face stretched to the population mean</p>
                <br>
            </div>
        </div>

        <p>
            These last two results are quite jarring, aren't they? That's because of two reasons:
            first, it's that my facial features are more vertically spread than average (just look
            at my long nose!); second, it's because my alignment isn't standardized to the other 
            photos, and I opted to have my hair and blank wall space in the photo. Thus, we're 
            stretching a lot of pixels around the edges to get these faces to morph into each other.
        </p>

        <hr>
        <hr>
        <hr>
        <hr>
        <hr>
        <hr>
        <hr>

        <p>
            Now, here are some samples of images from the collection, then stretched to the mean face.
        </p>
        <p>
        </p>
        <div id="stacked">
            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/4a.jpg" alt="4a">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/4a_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/16b.jpg" alt="16b">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/16b_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/61a.jpg" alt="61a">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/61a_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/61b.jpg" alt="61b">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/61b_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/161a.jpg" alt="161a">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/161a_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/149b.jpg" alt="149a">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/149b_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/186a.jpg" alt="186a">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/186a_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <div id="side-by-side">
                <div class="cell">
                    <img src="img/population/194a.jpg" alt="194a">
                    <p></p>
                    <br>
                </div>
    
                &
    
                <div class="cell">
                    <img src="out/194a_mean.png" alt="">
                    <p></p>
                    <br>
                </div>
    
            </div>

            <p>
                
            </p>
        </div>

        <hr>
        <hr>
        <hr>
        <hr>

        
    </div>
    
    <br>
    </div>

    <hr>


</body></html>
